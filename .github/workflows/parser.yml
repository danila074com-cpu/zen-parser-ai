name: Zen Parser

on:
  workflow_dispatch:
  schedule:
    - cron: '0 6 * * *'

jobs:
  parse-and-process:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout repository
      uses: actions/checkout@v4
      
    - name: ‚éî Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: üì¶ Install dependencies
      run: |
        npm ci
        
    - name: üï∑Ô∏è Parse Zen articles
      run: |
        echo "=== –ó–ê–ü–£–°–ö PARSER ==="
        node parser.js
        
    - name: üß† AI –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç–µ–π
      run: |
        echo "=== –ó–ê–ü–£–°–ö AI –û–ë–†–ê–ë–û–¢–ö–ò ==="
        node scripts/process-with-ai.js
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        KIE_API_KEY: ${{ secrets.KIE_API_KEY }}
        
    - name: üì§ Upload results
      uses: actions/upload-artifact@v4
      with:
        name: zen-articles
        path: |
          results/
          processed/
        retention-days: 7